#include <p16f877a.inc>
__config h'3f31'

GECÝK EQU 0X21
GECÝK2 EQU 0X22
KARAKTER EQU 0X23
SAYI EQU 0X23

ORG 0x00
	GOTO BASLA
ORG 0X04
KESME 
	RETFIE

BASLA
BANKSEL TRISB
	CLRF TRISB
	CLRF TRISD
	MOVLW 0XFF
	MOVWF TRISC
BANKSEL PORTC
	CLRF PORTC
	CLRF PORTB
	CLRF PORTD
CLRF SAYI
	CALL ILETISIM_AYARLARI
	CALL LCD_AYARLARI

DONGU
	CALL VERÝ_ÝÞLE
CALL GECIKME
	GOTO DONGU

ILETISIM_AYARLARI
BANKSEL SPBRG
	MOVLW D'25'
	MOVWF SPBRG
	BSF TXSTA,BRGH
BANKSEL RCSTA
	BSF RCSTA,SPEN
	BSF RCSTA,CREN
	RETURN

LCD_AYARLARI
	MOVLW 0X01
	CALL KOMUT_ÝÞLE
	MOVLW 0X02
	CALL KOMUT_ÝÞLE
	MOVLW 0X38
	CALL KOMUT_ÝÞLE
	MOVLW 0X0E
	CALL KOMUT_ÝÞLE
	BSF PORTB,2
	BCF PORTB,3
	BCF PORTB,5
	CLRF KARAKTER
	RETURN

KOMUT_ÝÞLE
	MOVWF PORTD
	BCF PORTB,4
	BSF PORTB,6	
	CALL GECIKME
	BCF PORTB,6
	RETURN

VERÝ_ÝÞLE
	MOVF SAYI,W
	CALL LOOK_UP
	MOVWF RCREG
	MOVF RCREG,W
	MOVWF PORTD	
	INCF SAYI
	BSF PORTB,4
	BSF PORTB,6
	CALL GECIKME
	BCF PORTB,6
	MOVLW D'4'
	SUBWF SAYI,W
	BTFSC STATUS,Z
	CLRF SAYI
	RETURN

LOOK_UP
	ADDWF PCL,F
	RETLW 0X53 ;A'S'
	RETLW 0X4F ;A'O'
	RETLW 0X53
	RETLW A' '
	RETURN

GECIKME
	MOVLW D'150'
	MOVWF GECÝK
	MOVWF GECÝK2
DON1
	DECFSZ GECÝK
	GOTO DON2
	RETURN
DON2 
	DECFSZ GECÝK2
	GOTO DON2
	MOVLW D'150'
	MOVWF GECÝK2
	GOTO DON1

END